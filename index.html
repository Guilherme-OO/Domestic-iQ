<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Domestic-iQ - Gestor de Funcion√°rios</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .error-banner {
            background-color: #fee;
            border: 1px solid #f88;
            color: #c33;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 16px;
        }
        .success-banner {
            background-color: #efe;
            border: 1px solid #8f8;
            color: #3c3;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 16px;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-600 to-purple-900 min-h-screen">
    <div id="app" class="container mx-auto max-w-6xl p-4 py-8">
        <!-- NAVBAR -->
        <nav class="bg-white rounded-lg shadow-lg mb-8">
            <div class="px-6 py-4 flex justify-between items-center flex-wrap gap-4">
                <div>
                    <h1 class="text-3xl font-bold text-purple-600">Domestic-iQ</h1>
                    <p class="text-gray-600 text-sm">Gestor de Funcion√°rios Dom√©sticos</p>
                </div>
                <div class="flex gap-2 flex-wrap">
                    <button onclick="showTab('dashboard')" class="px-4 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 text-sm">Dashboard</button>
                    <button onclick="showTab('funcionarios')" class="px-4 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 text-sm">Funcion√°rio</button>
                    <button onclick="showTab('pagamentos')" class="px-4 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 text-sm">Pagamentos</button>
                    <button onclick="showTab('relatorios')" class="px-4 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 text-sm">Relat√≥rios</button>
                    <button onclick="showTab('diagnostico')" class="px-4 py-2 rounded bg-orange-600 text-white hover:bg-orange-700 text-sm">Diagn√≥stico</button>
                </div>
            </div>
        </nav>

        <!-- DIAGN√ìSTICO TAB -->
        <div id="diagnostico-tab" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4">üîß Diagn√≥stico de Conex√£o</h2>
                <div id="diagnostico-container" class="space-y-4">
                    <p class="text-gray-600">Verificando conex√£o com Supabase...</p>
                </div>
            </div>
        </div>

        <!-- DASHBOARD TAB -->
        <div id="dashboard-tab" class="hidden">
            <div id="dashboard-error" class="hidden"></div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-gray-600 text-sm font-semibold mb-2">Total Gasto Este M√™s</h3>
                    <p class="text-3xl font-bold text-purple-600" id="total-mes">R$ 0,00</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-gray-600 text-sm font-semibold mb-2">Funcion√°rios Ativos</h3>
                    <p class="text-3xl font-bold text-green-600" id="funcionarios-ativos">0</p>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-gray-600 text-sm font-semibold mb-2">Total Gasto (Tudo)</h3>
                    <p class="text-3xl font-bold text-blue-600" id="total-geral">R$ 0,00</p>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4">√öltimos Pagamentos</h2>
                <div id="ultimos-pagamentos" class="space-y-3">
                    <p class="text-gray-500">Nenhum pagamento registrado ainda...</p>
                </div>
            </div>
        </div>

        <!-- FUNCION√ÅRIOS TAB -->
        <div id="funcionarios-tab" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold mb-6">Cadastro de Funcion√°rio</h2>
                <div id="funcionario-error" class="hidden"></div>
                <form id="form-funcionario" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" id="nome" placeholder="Nome Completo" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                        <input type="text" id="cpf" placeholder="CPF (000.000.000-00)" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="date" id="dataNascimento" placeholder="Data Nascimento" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600">
                        <input type="date" id="dataContratacao" placeholder="Data Contrata√ß√£o" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" id="cargo" placeholder="Cargo" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                        <input type="number" id="salarioBase" placeholder="Sal√°rio Base (R$)" step="0.01" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="email" id="email" placeholder="Email" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600">
                        <input type="tel" id="telefone" placeholder="Telefone" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600">
                    </div>
                    <textarea id="endereco" placeholder="Endere√ßo" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600"></textarea>
                    <button type="submit" class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold">Salvar Funcion√°rio</button>
                </form>
            </div>

            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4">Funcion√°rios Cadastrados</h2>
                <div id="lista-funcionarios" class="space-y-3">
                    <p class="text-gray-500">Nenhum funcion√°rio cadastrado ainda...</p>
                </div>
            </div>
        </div>

        <!-- PAGAMENTOS TAB -->
        <div id="pagamentos-tab" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold mb-6">Registrar Pagamento</h2>
                <div id="pagamento-error" class="hidden"></div>
                <form id="form-pagamento" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <select id="funcionarioId" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                            <option value="">Selecione um funcion√°rio</option>
                        </select>
                        <select id="tipo" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                            <option value="">Tipo de Pagamento</option>
                            <option value="salario">Sal√°rio</option>
                            <option value="beneficio">Benef√≠cio</option>
                            <option value="adiantamento">Adiantamento</option>
                            <option value="ressarcimento">Ressarcimento</option>
                            <option value="desconto">Desconto</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="date" id="dataPagamento" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                        <input type="number" id="valor" placeholder="Valor (R$)" step="0.01" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600" required>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" id="mesAnoReferencia" placeholder="M√™s/Ano (ex: 12/2025)" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600">
                        <input type="text" id="descricao" placeholder="Descri√ß√£o (opcional)" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-purple-600">
                    </div>
                    <button type="submit" class="w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold">Registrar Pagamento</button>
                </form>
            </div>

            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4">Hist√≥rico de Pagamentos</h2>
                <div id="lista-pagamentos" class="space-y-3">
                    <p class="text-gray-500">Nenhum pagamento registrado ainda...</p>
                </div>
            </div>
        </div>

        <!-- RELAT√ìRIOS TAB -->
        <div id="relatorios-tab" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6">Relat√≥rios</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-bold mb-3">Gasto por Tipo de Pagamento</h3>
                        <div id="relatorio-tipo" class="space-y-2">
                            <p class="text-gray-500">Nenhum dado...</p>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-bold mb-3">Resumo por Funcion√°rio</h3>
                        <div id="relatorio-funcionario" class="space-y-2">
                            <p class="text-gray-500">Nenhum dado...</p>
                        </div>
                    </div>
                </div>

                <button onclick="exportarPDF()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">Exportar para PDF</button>
            </div>
        </div>
    </div>

    <script>
        // Configura√ß√£o Supabase
        const SUPABASE_URL = 'https://dqukdcntjwgretusoags.supabase.co'
        const SUPABASE_KEY = 'sb_publishable_cphuJ-1_n1lbFeBjTMcfgA_rGMPMELb'
        const { createClient } = window.supabase
        const supabase = createClient(SUPABASE_URL, SUPABASE_KEY)

        // Estado global
        let funcionarios = []
        let pagamentos = []
        let conexaoOK = false

        // Mostrar aba
        function showTab(tab) {
            document.querySelectorAll('[id$="-tab"]').forEach(el => el.classList.add('hidden'))
            document.getElementById(tab + '-tab').classList.remove('hidden')
            
            if (tab === 'pagamentos') carregarFuncionarios()
            if (tab === 'dashboard') atualizarDashboard()
            if (tab === 'relatorios') atualizarRelatorios()
            if (tab === 'diagnostico') executarDiagnostico()
        }

        // Executar diagn√≥stico
        async function executarDiagnostico() {
            const container = document.getElementById('diagnostico-container')
            container.innerHTML = '<p class="text-gray-600">Verificando conex√£o...</p>'
            
            try {
                // Teste 1: Conectar ao Supabase
                const { data, error } = await supabase
                    .from('funcionarios')
                    .select('count', { count: 'exact' })
                
                let html = ''
                
                if (error) {
                    html += `
                        <div class="error-banner">
                            <strong>‚ùå Erro de Conex√£o:</strong><br>
                            ${error.message}
                        </div>
                        <div class="bg-gray-100 p-4 rounded">
                            <p class="font-bold mb-2">O que fazer:</p>
                            <ol class="list-decimal ml-5 space-y-1 text-sm">
                                <li>Certifique-se que as tabelas foram criadas no Supabase</li>
                                <li>Abra seu projeto Supabase ‚Üí SQL Editor</li>
                                <li>Cole e execute este c√≥digo:
                                    <pre class="bg-black text-white p-2 mt-2 text-xs rounded overflow-auto">
-- CRIAR POLICIES
CREATE POLICY "Enable SELECT for all users on funcionarios" ON public.funcionarios FOR SELECT USING (true);
CREATE POLICY "Enable INSERT for all users on funcionarios" ON public.funcionarios FOR INSERT WITH CHECK (true);
CREATE POLICY "Enable UPDATE for all users on funcionarios" ON public.funcionarios FOR UPDATE USING (true);
CREATE POLICY "Enable DELETE for all users on funcionarios" ON public.funcionarios FOR DELETE USING (true);

CREATE POLICY "Enable SELECT for all users on pagamentos" ON public.pagamentos FOR SELECT USING (true);
CREATE POLICY "Enable INSERT for all users on pagamentos" ON public.pagamentos FOR INSERT WITH CHECK (true);
CREATE POLICY "Enable UPDATE for all users on pagamentos" ON public.pagamentos FOR UPDATE USING (true);
CREATE POLICY "Enable DELETE for all users on pagamentos" ON public.pagamentos FOR DELETE USING (true);

CREATE POLICY "Enable SELECT for all users on auditoria" ON public.auditoria FOR SELECT USING (true);
CREATE POLICY "Enable INSERT for all users on auditoria" ON public.auditoria FOR INSERT WITH CHECK (true);

-- ATIVAR REALTIME
ALTER PUBLICATION supabase_realtime ADD TABLE public.funcionarios;
ALTER PUBLICATION supabase_realtime ADD TABLE public.pagamentos;
ALTER PUBLICATION supabase_realtime ADD TABLE public.auditoria;
                                    </pre>
                                </li>
                                <li>Clique em RUN</li>
                                <li>Atualize esta p√°gina (F5)</li>
                            </ol>
                        </div>
                    `
                } else {
                    html += `
                        <div class="success-banner">
                            <strong>‚úÖ Conex√£o OK!</strong><br>
                            Supabase est√° respondendo corretamente.
                        </div>
                    `
                    conexaoOK = true
                    
                    // Carregar dados
                    await carregarFuncionarios()
                    await carregarPagamentos()
                    
                    html += `
                        <div class="success-banner">
                            <strong>‚úÖ Funcion√°rios carregados:</strong> ${funcionarios.length}
                        </div>
                        <div class="success-banner">
                            <strong>‚úÖ Pagamentos carregados:</strong> ${pagamentos.length}
                        </div>
                    `
                }
                
                container.innerHTML = html
            } catch (err) {
                container.innerHTML = `
                    <div class="error-banner">
                        <strong>‚ùå Erro:</strong><br>
                        ${err.message}
                    </div>
                `
            }
        }

        // Carregar funcion√°rios
        async function carregarFuncionarios() {
            try {
                const { data, error } = await supabase
                    .from('funcionarios')
                    .select('*')
                    .order('criado_em', { ascending: false })
                
                if (error) {
                    console.error('Erro ao carregar funcion√°rios:', error)
                    return
                }
                funcionarios = data || []
                renderizarFuncionarios()
                atualizarSelectFuncionarios()
            } catch (err) {
                console.error('Erro:', err)
            }
        }

        // Renderizar funcion√°rios
        function renderizarFuncionarios() {
            const container = document.getElementById('lista-funcionarios')
            if (funcionarios.length === 0) {
                container.innerHTML = '<p class="text-gray-500">Nenhum funcion√°rio cadastrado ainda...</p>'
                return
            }
            
            container.innerHTML = funcionarios.map(f => `
                <div class="border rounded-lg p-4 bg-gray-50">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="font-bold text-lg">${f.nome}</h3>
                            <p class="text-gray-600 text-sm">CPF: ${f.cpf}</p>
                            <p class="text-gray-600 text-sm">Cargo: ${f.cargo}</p>
                            <p class="text-gray-600 text-sm">Sal√°rio: R$ ${parseFloat(f.salario_base).toFixed(2)}</p>
                            <p class="text-sm mt-2 ${f.status === 'ativo' ? 'text-green-600' : 'text-red-600'}">Status: ${f.status}</p>
                        </div>
                        <button onclick="deletarFuncionario('${f.id}')" class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm">Deletar</button>
                    </div>
                </div>
            `).join('')
        }

        // Atualizar select de funcion√°rios
        function atualizarSelectFuncionarios() {
            const select = document.getElementById('funcionarioId')
            select.innerHTML = '<option value="">Selecione um funcion√°rio</option>' + funcionarios.filter(f => f.status === 'ativo').map(f => `
                <option value="${f.id}">${f.nome}</option>
            `).join('')
        }

        // Carregar pagamentos
        async function carregarPagamentos() {
            try {
                const { data, error } = await supabase
                    .from('pagamentos')
                    .select(`*`)
                    .order('data_pagamento', { ascending: false })
                
                if (error) {
                    console.error('Erro ao carregar pagamentos:', error)
                    return
                }
                pagamentos = data || []
                renderizarPagamentos()
            } catch (err) {
                console.error('Erro:', err)
            }
        }

        // Renderizar pagamentos
        function renderizarPagamentos() {
            const container = document.getElementById('lista-pagamentos')
            if (pagamentos.length === 0) {
                container.innerHTML = '<p class="text-gray-500">Nenhum pagamento registrado ainda...</p>'
                return
            }
            
            container.innerHTML = pagamentos.map(p => {
                const funcionario = funcionarios.find(f => f.id === p.funcionario_id)
                return `
                    <div class="border rounded-lg p-4 bg-gray-50 flex justify-between items-center">
                        <div>
                            <p class="font-bold">${funcionario?.nome || 'Desconhecido'}</p>
                            <p class="text-gray-600 text-sm">${p.tipo} - ${p.descricao || ''}</p>
                            <p class="text-gray-600 text-sm">${new Date(p.data_pagamento).toLocaleDateString('pt-BR')}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold text-lg text-blue-600">R$ ${parseFloat(p.valor).toFixed(2)}</p>
                            <button onclick="deletarPagamento('${p.id}')" class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm mt-2">Deletar</button>
                        </div>
                    </div>
                `
            }).join('')
        }

        // Atualizar dashboard
        async function atualizarDashboard() {
            await carregarFuncionarios()
            await carregarPagamentos()

            // Calcular totais
            const hoje = new Date()
            const mesAtual = `${String(hoje.getMonth() + 1).padStart(2, '0')}/${hoje.getFullYear()}`
            
            const pagamentosMes = pagamentos.filter(p => {
                if (!p.mes_ano_referencia) return false
                return p.mes_ano_referencia === mesAtual || p.mes_ano_referencia.endsWith(`/${hoje.getFullYear()}`)
            })
            const totalMes = pagamentosMes.reduce((sum, p) => sum + parseFloat(p.valor || 0), 0)
            const totalGeral = pagamentos.reduce((sum, p) => sum + parseFloat(p.valor || 0), 0)
            const funcionariosAtivos = funcionarios.filter(f => f.status === 'ativo').length

            document.getElementById('total-mes').textContent = `R$ ${totalMes.toFixed(2)}`
            document.getElementById('total-geral').textContent = `R$ ${totalGeral.toFixed(2)}`
            document.getElementById('funcionarios-ativos').textContent = funcionariosAtivos

            // √öltimos pagamentos
            const container = document.getElementById('ultimos-pagamentos')
            const ultimos = pagamentos.slice(0, 5)
            if (ultimos.length === 0) {
                container.innerHTML = '<p class="text-gray-500">Nenhum pagamento registrado ainda...</p>'
            } else {
                container.innerHTML = ultimos.map(p => {
                    const funcionario = funcionarios.find(f => f.id === p.funcionario_id)
                    return `
                        <div class="flex justify-between items-center border-b pb-2">
                            <div>
                                <p class="font-semibold">${funcionario?.nome || 'Desconhecido'}</p>
                                <p class="text-gray-600 text-sm">${p.tipo}</p>
                            </div>
                            <p class="font-bold">R$ ${parseFloat(p.valor || 0).toFixed(2)}</p>
                        </div>
                    `
                }).join('')
            }
        }

        // Atualizar relat√≥rios
        async function atualizarRelatorios() {
            // Relat√≥rio por tipo
            const porTipo = {}
            pagamentos.forEach(p => {
                porTipo[p.tipo] = (porTipo[p.tipo] || 0) + parseFloat(p.valor || 0)
            })

            const containerTipo = document.getElementById('relatorio-tipo')
            if (Object.keys(porTipo).length === 0) {
                containerTipo.innerHTML = '<p class="text-gray-500">Nenhum dado...</p>'
            } else {
                containerTipo.innerHTML = Object.entries(porTipo).map(([tipo, valor]) => `
                    <div class="flex justify-between">
                        <span>${tipo}</span>
                        <span class="font-bold">R$ ${valor.toFixed(2)}</span>
                    </div>
                `).join('')
            }

            // Relat√≥rio por funcion√°rio
            const porFuncionario = {}
            pagamentos.forEach(p => {
                const func = funcionarios.find(f => f.id === p.funcionario_id)
                const nome = func?.nome || 'Desconhecido'
                porFuncionario[nome] = (porFuncionario[nome] || 0) + parseFloat(p.valor || 0)
            })

            const containerFunc = document.getElementById('relatorio-funcionario')
            if (Object.keys(porFuncionario).length === 0) {
                containerFunc.innerHTML = '<p class="text-gray-500">Nenhum dado...</p>'
            } else {
                containerFunc.innerHTML = Object.entries(porFuncionario).map(([nome, valor]) => `
                    <div class="flex justify-between">
                        <span>${nome}</span>
                        <span class="font-bold">R$ ${valor.toFixed(2)}</span>
                    </div>
                `).join('')
            }
        }

        // Submeter formul√°rio de funcion√°rio
        document.getElementById('form-funcionario').addEventListener('submit', async (e) => {
            e.preventDefault()
            
            try {
                const { data, error } = await supabase
                    .from('funcionarios')
                    .insert([{
                        nome: document.getElementById('nome').value,
                        cpf: document.getElementById('cpf').value,
                        data_nascimento: document.getElementById('dataNascimento').value || null,
                        data_contratacao: document.getElementById('dataContratacao').value,
                        cargo: document.getElementById('cargo').value,
                        salario_base: parseFloat(document.getElementById('salarioBase').value),
                        email: document.getElementById('email').value || null,
                        telefone: document.getElementById('telefone').value || null,
                        endereco: document.getElementById('endereco').value || null,
                        status: 'ativo'
                    }])
                    .select()
                
                if (error) throw error
                
                alert('‚úÖ Funcion√°rio cadastrado com sucesso!')
                document.getElementById('form-funcionario').reset()
                carregarFuncionarios()
            } catch (err) {
                alert('‚ùå Erro ao cadastrar: ' + err.message)
            }
        })

        // Submeter formul√°rio de pagamento
        document.getElementById('form-pagamento').addEventListener('submit', async (e) => {
            e.preventDefault()
            
            try {
                const { data, error } = await supabase
                    .from('pagamentos')
                    .insert([{
                        funcionario_id: document.getElementById('funcionarioId').value,
                        tipo: document.getElementById('tipo').value,
                        descricao: document.getElementById('descricao').value || null,
                        valor: parseFloat(document.getElementById('valor').value),
                        data_pagamento: document.getElementById('dataPagamento').value,
                        mes_ano_referencia: document.getElementById('mesAnoReferencia').value || null
                    }])
                    .select()
                
                if (error) throw error
                
                alert('‚úÖ Pagamento registrado com sucesso!')
                document.getElementById('form-pagamento').reset()
                carregarPagamentos()
            } catch (err) {
                alert('‚ùå Erro ao registrar: ' + err.message)
            }
        })

        // Deletar funcion√°rio
        async function deletarFuncionario(id) {
            if (!confirm('Deseja realmente deletar este funcion√°rio?')) return
            
            try {
                const { error } = await supabase
                    .from('funcionarios')
                    .update({ status: 'inativo' })
                    .eq('id', id)
                
                if (error) throw error
                
                alert('‚úÖ Funcion√°rio deletado!')
                carregarFuncionarios()
            } catch (err) {
                alert('‚ùå Erro: ' + err.message)
            }
        }

        // Deletar pagamento
        async function deletarPagamento(id) {
            if (!confirm('Deseja realmente deletar este pagamento?')) return
            
            try {
                const { error } = await supabase
                    .from('pagamentos')
                    .delete()
                    .eq('id', id)
                
                if (error) throw error
                
                alert('‚úÖ Pagamento deletado!')
                carregarPagamentos()
            } catch (err) {
                alert('‚ùå Erro: ' + err.message)
            }
        }

        // Exportar para PDF
        function exportarPDF() {
            alert('Fun√ß√£o de exportar PDF ser√° implementada em breve!')
        }

        // Carregar dados iniciais
        window.addEventListener('load', () => {
            showTab('dashboard')
        })
    </script>
</body>
</html>